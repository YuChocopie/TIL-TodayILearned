# 비잔티움 장애 허용(Byzantine Fault Tolerance) 

[두 장군 문제](https://ko.wikipedia.org/wiki/%EB%91%90_%EC%9E%A5%EA%B5%B0_%EB%AC%B8%EC%A0%9C)([Two Generals Problem](https://en.wikipedia.org/wiki/Two_Generals%27_Problem))를 일반화한 문제인 **비잔티움 장군 문제**(Byzantine Generals Problem)로부터 파생된 장애 허용 분야 연구의 한 갈래

비잔티움 장애로 불리는 시스템에 생길 수 있는 임의의 장애를 견딜 수 있는 시스템을 만들기 위해 연구하는 분야이다.

시스템이 멈추거나 에러 메세지를 내보내는 것과 같은 장애 뿐만 아니라, 잘못된 값을 다른 시스템에 전달하는 등 좀 더 원인을 파악하기 어려운 장애들을 포함한다. 제대로 구현된 비잔티움 장애 허용 시스템에서는 미리 정해진 정도를 넘지 않는다면 어떤 형태의 장애가 있더라도 정확한 값을 전달할 수 있다.

## 비잔티움 장군 문제

- 300명의 병력이 있는 비잔틴 성을 100명씩 병력을 가진 장군 5명이 치려 한다.
- 이기려면 적 병력보다 많은 병력이 공격을 해야 한다.
- 장군들은 연락병을 보내 소통이 가능하다.
- 장군들 중에는 배신자가 있어서 서로 신뢰가 불가하다. 
- 문제)서로 신뢰할 수 없는데, 어떻게 공격 시각을 합의할 수 있는가?
  - 가정 1 - 공격 시각은 상관 없음. 모두 한번에 공격할 수 있는 합의된 시각이면 됨
  - 가정 2 - 배신자는 병력을 분산시키려 하므로 이전 장군의 메시지와 다른 시각을 제시함
  - 가정 3 - 각 장군은 자신의 바로 다음 장군에게만 연락할 수 있음
  - 가정 4 - 배신자도 지정한 시간에 공격에 가담 

![img](https://t1.daumcdn.net/cfile/tistory/2568F43A56F688EB1C)

- 문제 발생

  - @J1 이 "9 AM" 공격시각을 적어 서명과 함께 @J2 에게 보냄 

  - @J2 는 @J1 의 "9 AM" 공격시각을 보고 기억한 후 @J3 에게 전달함

  - @J3 은 배신자로, "9 AM" 메시지를 찢어버리고 "8 AM" 으로 고쳐서 @J 4에게 전달함

  - @J4 는 "8AM" 을 기억한 후 @J5 에게 전달

  - @J5 는 "8AM" 을 기억

  - 8AM 에 @J3, @J4, @J5 가 쳐들어가지만 300명이므로 지게 됨

    >

#### POW 블록체인 해결

[새로운 규칙]

A. 장군은 메시지를 보내기 위해 반드시 10분의 시간을 들여야 한다

B. 메시지는 모든 이전 장군의 메시지와 10분의 시간을 들였다는 증거를 포함하여 보내야 한다

 	1. @J1 이 "9 AM" 공격시각을 적어 10분간 작업하여 증거와 함께 @장군2 에게 보냄
 	2. @J2 는 "9 AM" 메시지와 @J1 의 10분 작업 증거를 보고 확신 후, @J3 에게 "9 AM" 메시지 보냄\
      	1. @J2 도 10분 간 작업 함 
     	2. @J1, @J2 의 메시지와 작업내용 모두를 포함하여 보냄
	3. @J3 은 배신자로 "8AM" 으로 메시지를 수정하여 보내고 싶으나 그냥 보낼 수 없다. (아래 중 택 1)
    1. 속일 수 있는 유일한 방법
       1. @장군3 은 10분보다 빠르게 작업을 하여 "8 AM" 메시지를 만들어 냄
       2. @장군1, @장군2 의 총 20분 작업에 해당하는 메시지 모두를 남은 시간 내에 만들어 포함 시켜 보냄
    2. 안들키기 위해 "9 AM" 으로 보내기
	4. @J4, @J5 모두 동일

[결과]

1. 만약 @J3 이 "8AM" 으로 보냈다면, 모두 J3이 거짓임을 알게 됨
2. 만약 @J2 가 배신자였다면 @J2,3,4,5 모두 9AM 공격 가므로 이기게 됨
3. 만약 @J1 이 배신자였다면 8AM 에 모두 함께 공격 가므로 이기게 됨







